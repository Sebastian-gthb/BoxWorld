10 CLS:WIDTH20,16:MEMSET&HB00:DEFINTA-Z:OPTIONBASE0:DIM A(16,16):DIM B(255,0)
20 LOCATE6,0:PRINT "Box World":PRINT" by Jeng-Long Jiang";:GOSUB440
30 PRINT"    HX-20 Version":PRINT"by Sebastian Berger";:GOSUB440
40 CLS:PRINT"Controls   ";CHR$(155);"W":PRINT"      <-A  ";CHR$(156);"S  D->"
50 PRINT"R=restart  O=off":PRINT"P=print level";:GOSUB440
60 POKE&H11E,&HA:POKE&H11F,&H40:RESTORE460:FORI=&HA40 TO&HA6F:READJ:POKEI,J:NEXTI
70 CLS:INPUT"LEVEL  (1-26)";L:IFL<1ORL>26THENSOUND1,1:GOTO70
80 C=0:ONL GOSUB480,500,520,540,560,580,610,630,650,670,690,710,730,750,770,790,810,830,850,870,890,910,930,950,960,990
100 READX:READY:READX1:READY1:FORJ=0TO15:FORI=0TO15:A(I,J)=0:NEXTI,J
110 B=(X+1)*(Y+1):Z=0
120 READD:IFD>9THEND=D-8:E=5:GOTO170
140 IFD>7THEND=D-6:E=1:GOTO170
150 IFD>5THEND=D-4:E=0:GOTO170
160 B(Z,0)=D:Z=Z+1:GOTO180
170 FORI=1TOD:B(Z,0)=E:Z=Z+1:NEXTI
180 IFZ<B GOTO120
190 Z=0:A$=INKEY$:A$=INKEY$:A$=INKEY$:A$=INKEY$
200 CLS:FORJ=0TOY:LOCATE0,J:FORI=0TOX:A(I,J)=B(Z,0):Z=Z+1:IFA(I,J)=3THENC=C+1
210 PRINTCHR$(224+A(I,J));:NEXT I,J
220 LOCATES0,Y1-1,0:LOCATE X1,Y1:PRINTCHR$(154);
230 A$=INPUT$(1):IFA$="D"THENX2=X1+1:X3=X1+2:Y2=Y1:Y3=Y1:GOTO310
240 IFA$="A"THENX2=X1-1:X3=X1-2:Y2=Y1:Y3=Y1:GOTO310
250 IFA$="W"THENY2=Y1-1:Y3=Y1-2:X2=X1:X3=X1:GOTO310
260 IFA$="S"THENY2=Y1+1:Y3=Y1+2:X2=X1:X3=X1:GOTO310
270 IFA$="R"THEN80
280 IFA$="P"THENI=0:GOTO420
290 IFA$="O"THEN410
300 SOUND1,1:GOTO 230
310 ONA(X2,Y2)GOSUB370,370,330,330,450
320 IFC=0THEN400ELSE230
330 IFA(X3,Y3)>2THEN450
340 IFA(X2,Y2)=3ANDA(X3,Y3)=2THENC=C-1
350 IFA(X2,Y2)=4ANDA(X3,Y3)=1THENC=C+1
360 A(X3,Y3)=A(X3,Y3)+2:A(X2,Y2)=A(X2,Y2)-2
370 IFY1<Y2 THENLOCATES0,Y1-1,0
380 LOCATEX1,Y1:PRINTCHR$(224+A(X1,Y1));:LOCATEX2,Y2:PRINTCHR$(154);
390 LOCATEX3,Y3:PRINTCHR$(224+A(X3,Y3));:X1=X2:Y1=Y2:RETURN
400 GOSUB440:L=L+1:IFL<=26THEN80
410 CLS:END
420 FORI=0TOY STEP4:LOCATES0,I:COPY:NEXTI
430 LOCATES0,Y1-1,0:GOTO230
440 FORI=1TO28:J=I^2-56*(I^2\56):SOUNDJ,1:NEXTI:RETURN
450 SOUND1,1:RETURN
460 DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,66,36,24,36,66,0,255,249,189,159,255,0,255,135,195
470 DATA 225,255,119,7,119,119,112,119,0,198,40,31,107,136,0,0,0,0,0,0,0,0,0,0,0,0
480 RESTORE 490:RETURN
490 DATA 7,7,4,4,6,11,7,6,5,2,5,7,6,5,1,15,3,1,3,2,10,2,1,3,1,15,3,5,7,6,5,2,5,7,6,11,6
500 RESTORE 510:RETURN
510 DATA 8,8,1,1,13,7,0,5,9,5,7,0,5,1,3,3,5,0,12,1,3,1,5,0,5,2,12,1,11,2,5,0,10,9,1,2,5,0,5,9,5,8,5,0,5,9,12,0,13,7
520 RESTORE 530:RETURN
530 DATA 9,6,2,3,0,15,7,5,9,8,13,3,11,9,10,9,3,8,3,1,10,1,2,2,5,1,3,1,12,2,2,5,1,1,1,5,6,16,0
540 RESTORE 550:RETURN
550 DATA 5,7,1,2,0,12,0,10,8,5,0,5,1,3,1,5,0,10,3,1,12,1,3,1,10,2,3,8,10,2,2,4,2,15
560 RESTORE 570:RETURN
570 DATA 7,7,2,1,0,12,7,0,5,1,1,11,6,5,1,3,8,5,0,11,1,5,1,11,2,5,1,5,8,10,2,3,8,5,1,10,2,9,3,1,17
580 RESTORE 590:RETURN
590 DATA 12,10,11,8,7,15,7,12,9,8,5,7,5,9,2,11,1,5,7,5,1,5,1,5,9,1,10,6,5,1,5,1,3,1,3,5,2,1,5,6,5,1,5,8
600 DATA 4,8,5,1,5,6,5,1,2,5,3,1,3,1,5,1,5,6,10,9,1,5,1,5,1,11,0,5,1,11,2,9,8,5,0,5,9,8,10,9,5,0,20
610 RESTORE 610:RETURN
620 DATA 9,7,8,1,7,15,6,10,8,5,8,5,6,5,9,5,8,5,6,5,3,1,3,1,3,1,5,6,5,1,3,10,8,12,1,3,1,5,1,11,2,2,2,2,2,8,5,0,17,0
630 RESTORE 640:RETURN
640 DATA 9,6,8,3,7,14,6,11,9,1,5,0,10,2,1,3,10,1,11,2,2,3,1,3,9,10,2,2,1,3,1,3,1,14,10,8,5,7,7,12,0
650 RESTORE 660:RETURN
660 DATA 10,8,8,7,0,17,6,5,8,10,9,5,6,5,9,3,9,5,6,5,3,1,11,1,3,5,6,5,1,5,2,2,2,5,1,5,0,10,1,5,2,2,2,5,1,11,1,3,8,3,8,3,1,10,9,8,5,9,20
670 RESTORE 680:RETURN
680 DATA 7,6,1,3,6,14,6,5,9,1,12,3,3,3,1,10,8,3,2,2,1,10,1,3,2,2,2,14,8,5,7,0,12,0
690 RESTORE 700:RETURN
700 DATA 11,5,8,4,0,12,6,15,8,5,6,5,9,10,1,3,1,12,3,8,10,8,3,2,2,2,2,1,3,1,11,9,1,5,9,10,0,17,5,0
710 RESTORE 720:RETURN
720 DATA 7,6,5,1,6,13,0,11,9,5,0,5,8,3,2,1,11,8,2,3,2,1,12,1,4,3,1,5,6,5,9,10,6,13,0
730 RESTORE 740:RETURN
740 DATA 7,7,3,6,6,12,7,0,5,2,2,5,7,10,1,2,10,6,5,8,3,2,5,0,10,1,3,8,11,8,5,3,3,1,10,9,9,17
750 RESTORE 760:RETURN
760 DATA 7,6,1,3,17,8,5,9,10,1,3,2,2,3,1,10,1,3,2,4,1,11,1,3,2,2,3,1,10,8,5,9,17
770 RESTORE 780:RETURN
780 DATA 7,6,4,5,0,14,0,10,9,1,11,1,3,1,3,3,1,10,2,2,2,2,2,2,10,1,3,3,1,3,1,12,8,11,6,12,6
790 RESTORE 800:RETURN
800 DATA 9,8,6,7,6,13,7,6,5,9,12,6,5,1,3,9,1,12,1,3,1,10,1,10,2,2,2,1,3,9,10,2,2,2,3,5,3,1,14,1,5,1,3,1,5,7,5,9,8,5,7,15
810 RESTORE 820:RETURN
820 DATA 8,6,3,5,14,7,5,9,1,5,7,5,1,3,3,3,10,6,5,8,5,2,2,13,8,2,2,3,1,5,0,5,9,9,5,0,16
830 RESTORE 840:RETURN
840 DATA 9,8,7,7,6,16,6,5,9,5,2,1,5,0,10,8,3,2,2,2,5,0,5,8,3,1,5,4,2,11,1,10,3,5,1,11,9,3,8,3,1,10,9,5,9,1,16,8,5,7,7,12
850 RESTORE 860:RETURN
860 DATA 9,7,5,6,0,15,7,5,2,2,2,2,1,5,6,11,2,2,2,3,12,8,3,5,3,1,3,1,10,1,3,3,8,5,3,1,10,9,1,5,9,13,9,11,7,13,6
870 RESTORE 880:RETURN
880 DATA 6,7,4,6,16,2,2,3,2,2,10,2,2,5,2,2,10,1,3,3,3,1,10,8,3,8,10,1,3,3,3,1,10,8,5,8,16
890 RESTORE 900:RETURN
900 DATA 10,7,1,5,7,14,7,6,5,1,2,2,2,5,6,12,2,2,2,2,5,6,5,8,11,3,1,12,1,3,1,3,8,3,3,1,10,8,3,1,3,9,1,10,9,11,9,14,0,14
910 RESTORE 920:RETURN
920 DATA 8,8,7,7,16,0,5,9,9,5,0,5,1,5,3,3,8,5,0,5,1,2,2,2,5,1,5,0,10,2,2,2,3,1,10,0,5,1,10,1,3,1,5,0,5,3,8,3,8,5,0,5,8,5,9,5,0,16
930 RESTORE 940:RETURN
940 DATA 9,7,8,3,6,13,7,11,9,13,9,3,1,3,8,10,1,3,9,3,8,12,3,3,13,6,5,8,2,2,5,7,0,5,2,2,2,2,5,7,0,14,6
950 RESTORE 960:RETURN
960 DATA 13,8,11,4,14,7,14,9,1,11,0,5,8,2,10,8,3,1,3,1,5,0,5,2,2,2,10,1,5,8,3,1,11,8,2,10,8,3,3,3,9,3,8,2,12,8,3,8,3,5,8,2,5,6,5,8,3
970 DATA 5,3,1,5,2,2,2,5,6,10,9,8,5,8,2,5,7,19
960 RESTORE 970:RETURN
970 DATA 10,9,1,8,7,6,14,0,13,2,9,5,0,5,8,5,2,2,10,1,5,0,5,8,3,2,2,9,5,0,5,8,5,1,2,5,1,13,1,10,3,5,8,10,1,3,9,1,3,3,1,10,1,5,3,5,8,5
980 DATA 8,10,9,20,7,7
990 RESTORE 1000:RETURN
1000 DATA 12,11,10,8,0,17,7,0,5,9,10,8,12,0,5,1,3,9,9,8,5,0,10,3,11,1,10,8,5,0,5,8,10,1,4,1,5,1,10,0,5,1,3,2,2,2,2,2,2,1,5,0,10,1,11
1010 DATA 1,2,1,5,1,5,0,5,9,8,3,11,3,5,0,5,9,5,9,1,3,1,5,0,13,3,5,1,12,7,6,5,9,5,7,7,6,13,7,0
2000 '10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,
2010 ' 2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18
2020 'EOF